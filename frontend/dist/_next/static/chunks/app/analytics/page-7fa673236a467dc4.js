(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[745],{1172:(e,t,a)=>{"use strict";a.d(t,{AJ:()=>s,Dq:()=>i,MT:()=>n,OK:()=>o,Xz:()=>l,sk:()=>r});let s=e=>{let t=new Map;return e.forEach(e=>{let a=t.get(e.industry)||{count:0,totalRevenue:0,totalEmployees:0};t.set(e.industry,{count:a.count+1,totalRevenue:a.totalRevenue+e.revenue,totalEmployees:a.totalEmployees+e.employees})}),Array.from(t.entries()).map(e=>{let[t,a]=e;return{industry:t,count:a.count,totalRevenue:a.totalRevenue,averageEmployees:Math.round(a.totalEmployees/a.count)}})},r=e=>{let t=new Map;return e.forEach(e=>{let a=t.get(e.region)||{count:0,totalRevenue:0,totalEmployees:0};t.set(e.region,{count:a.count+1,totalRevenue:a.totalRevenue+e.revenue,totalEmployees:a.totalEmployees+e.employees})}),Array.from(t.entries()).map(e=>{let[t,a]=e;return{region:t,count:a.count,totalRevenue:a.totalRevenue,averageEmployees:Math.round(a.totalEmployees/a.count)}})},n=e=>{let t=0,a=[];return e.forEach((e,s)=>{var r;let n=!0,l=[];e.name&&0!==e.name.trim().length||(l.push("Отсутствует название"),n=!1),(null==(r=e.contactInfo)?void 0:r.address)&&0!==e.contactInfo.address.trim().length||(l.push("Отсутствует адрес"),n=!1),e.employees<0&&(l.push("Некорректное количество сотрудников"),n=!1),e.revenue<0&&(l.push("Некорректная выручка"),n=!1),n?t++:a.push("Запись ".concat(s+1,": ").concat(l.join(", ")))}),{totalRecords:e.length,validRecords:t,invalidRecords:e.length-t,validationErrors:a}},l=(e,t)=>e.filter(e=>{if(t.dateRange){let a=new Date(e.registrationDate);if(a<t.dateRange.from||a>t.dateRange.to)return!1}return(!t.industries||!(t.industries.length>0)||!!t.industries.includes(e.industry))&&(!t.regions||!(t.regions.length>0)||!!t.regions.includes(e.region))&&(!t.employeeRange||!(e.employees<t.employeeRange.min)&&!(e.employees>t.employeeRange.max))&&(!t.revenueRange||!(e.revenue<t.revenueRange.min)&&!(e.revenue>t.revenueRange.max))}),o=e=>{let t=new Map;return e.forEach(e=>{let a=new Date(e.registrationDate),s="".concat(a.getFullYear(),"-").concat(String(a.getMonth()+1).padStart(2,"0")),r=t.get(s)||{count:0,revenue:0};t.set(s,{count:r.count+1,revenue:r.revenue+e.revenue})}),Array.from(t.entries()).sort((e,t)=>{let[a]=e,[s]=t;return a.localeCompare(s)}).map(e=>{let[t,a]=e;return{month:t,count:a.count,revenue:a.revenue}})},i=e=>{let t=e.reduce((e,t)=>e+t.revenue,0),a=e.reduce((e,t)=>e+t.employees,0),s=e.reduce((e,t)=>e+t.taxesPaid,0),r=e.filter(e=>"active"===e.status).length,n=e.filter(e=>"inactive"===e.status).length,l=e.filter(e=>"suspended"===e.status).length;return{totalEnterprises:e.length,totalRevenue:t,totalEmployees:a,totalTaxes:s,averageRevenue:e.length>0?t/e.length:0,averageEmployees:e.length>0?a/e.length:0,statusDistribution:{active:r,inactive:n,suspended:l}}}},2383:()=>{},3686:()=>{},3991:(e,t,a)=>{Promise.resolve().then(a.bind(a,9152))},4951:(e,t,a)=>{"use strict";a.d(t,{Az:()=>h,Bp:()=>o,CO:()=>d,LW:()=>c,N9:()=>l,ZV:()=>u,vv:()=>m});var s=a(4246),r=a(9349),n=a.n(r);let l=["Центральный","Северный","Северо-Восточный","Восточный","Юго-Восточный","Южный","Юго-Западный","Западный","Северо-Западный","Новомосковский","Троицкий"],o=["Машиностроение","Пищевая промышленность","Химическая промышленность","Текстильная промышленность","Металлургия","Электроника","Строительные материалы","Фармацевтика","Автомобилестроение","Полиграфия","Другое"],i=e=>{let t=[];e.name&&"string"==typeof e.name||t.push("Некорректное название предприятия"),e.industry&&o.includes(e.industry)||t.push("Некорректная отрасль"),e.region&&l.includes(e.region)||t.push("Некорректный регион"),(!e.employees||0>Number(e.employees))&&t.push("Некорректное количество сотрудников"),(!e.revenue||0>Number(e.revenue))&&t.push("Некорректная выручка");let a=e.contactInfo;return(null==a?void 0:a.address)||t.push("Отсутствует адрес"),{isValid:0===t.length,errors:t}},d=e=>new Promise(t=>{n().parse(e,{header:!0,complete:e=>{let a=[],s=[],r=0;e.data.forEach((e,t)=>{let n=i(e);if(n.isValid){let t={id:crypto.randomUUID(),name:String(e.name),industry:String(e.industry),region:String(e.region),employees:parseInt(String(e.employees))||0,revenue:parseFloat(String(e.revenue))||0,taxesPaid:parseFloat(String(e.taxesPaid))||0,registrationDate:new Date(String(e.registrationDate)||Date.now()),lastUpdated:new Date,status:e.status||"active",contactInfo:{address:String(e.address),phone:String(e.phone||""),email:String(e.email||"")}};a.push(t)}else r++,s.push("Строка ".concat(t+1,": ").concat(n.errors.join(", ")))}),t({success:!0,message:"Обработано ".concat(a.length," записей из ").concat(e.data.length),processedCount:a.length,errorCount:r,errors:s,data:a})},error:e=>{t({success:!1,message:"Ошибка парсинга CSV: ".concat(e.message),processedCount:0,errorCount:1,errors:[e.message]})}})}),c=e=>new Promise(t=>{let a=new FileReader;a.onload=e=>{try{var a;let r=null==(a=e.target)?void 0:a.result,n=s.LF(r,{type:"binary"}),l=n.SheetNames[0],o=n.Sheets[l],d=s.Wp.sheet_to_json(o),c=[],u=[],m=0;d.forEach((e,t)=>{let a=i(e);if(a.isValid){let t={id:crypto.randomUUID(),name:String(e.name),industry:String(e.industry),region:String(e.region),employees:parseInt(String(e.employees))||0,revenue:parseFloat(String(e.revenue))||0,taxesPaid:parseFloat(String(e.taxesPaid))||0,registrationDate:new Date(String(e.registrationDate)||Date.now()),lastUpdated:new Date,status:e.status||"active",contactInfo:{address:String(e.address),phone:String(e.phone||""),email:String(e.email||"")}};c.push(t)}else m++,u.push("Строка ".concat(t+1,": ").concat(a.errors.join(", ")))}),t({success:!0,message:"Обработано ".concat(c.length," записей из ").concat(d.length),processedCount:c.length,errorCount:m,errors:u,data:c})}catch(e){t({success:!1,message:"Ошибка парсинга Excel: ".concat(e.message),processedCount:0,errorCount:1,errors:[e.message]})}},a.readAsBinaryString(e)}),u=e=>new Intl.NumberFormat("ru-RU").format(e),m=e=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB"}).format(e),h=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=[];for(let a=0;a<e;a++){let e={id:crypto.randomUUID(),name:"Предприятие ".concat(a+1),industry:o[Math.floor(Math.random()*o.length)],region:l[Math.floor(Math.random()*l.length)],employees:Math.floor(1e3*Math.random())+10,revenue:Math.floor(1e8*Math.random())+1e6,taxesPaid:Math.floor(1e7*Math.random())+1e5,registrationDate:new Date(Date.now()-365*Math.random()*432e6),lastUpdated:new Date,status:Math.random()>.1?"active":Math.random()>.5?"inactive":"suspended",contactInfo:{address:"Москва, улица ".concat(a+1,", дом ").concat(Math.floor(100*Math.random())+1),phone:"+7-495-".concat(Math.floor(900*Math.random())+100,"-").concat(Math.floor(90*Math.random())+10,"-").concat(Math.floor(90*Math.random())+10),email:"contact".concat(a+1,"@enterprise.ru")}};t.push(e)}return t}},9152:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>S});var s=a(5155),r=a(2115),n=a(6991),l=a(8128),o=a(8425),i=a(7734),d=a(3697),c=a(232),u=a(8155),m=a(2723),h=a(4035),g=a(9386),x=a(19),p=a(9585),v=a(6955),y=a(9867),j=a(1524),f=a(534),b=a(7454),N=a(4951),w=a(1172);let R=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#06B6D4","#F97316","#84CC16","#EC4899","#6366F1"];function S(){var e,t,a,S;let[E,M]=(0,r.useState)([]),[D,C]=(0,r.useState)([]),[k,F]=(0,r.useState)(!0),[I,A]=(0,r.useState)(!1),[U,B]=(0,r.useState)({});if((0,r.useEffect)(()=>{let e=(0,N.Az)(500);M(e),C(e),F(!1)},[]),(0,r.useEffect)(()=>{C((0,w.Xz)(E,U))},[E,U]),k)return(0,s.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,s.jsx)("div",{className:"text-lg text-gray-600",children:"Загрузка данных..."})});let V=(0,w.AJ)(D),P=(0,w.sk)(D),_=(0,w.OK)(D),K=(e,t)=>{B(a=>({...a,[e]:t}))};return(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Аналитика предприятий"}),(0,s.jsxs)("p",{className:"text-gray-600 mt-2",children:["Детальный анализ данных ",D.length," предприятий из ",E.length]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("button",{onClick:()=>A(!I),className:"flex items-center space-x-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[(0,s.jsx)(v.A,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"Фильтры"})]}),(0,s.jsxs)("button",{className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[(0,s.jsx)(y.A,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"Экспорт"})]})]})]}),I&&(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Фильтры"}),(0,s.jsx)("button",{onClick:()=>{B({})},className:"text-sm text-blue-600 hover:text-blue-800",children:"Очистить все"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Отрасли"}),(0,s.jsx)("select",{multiple:!0,className:"w-full p-2 border border-gray-300 rounded-lg",value:U.industries||[],onChange:e=>{K("industries",Array.from(e.target.selectedOptions,e=>e.value))},children:N.Bp.map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Регионы"}),(0,s.jsx)("select",{multiple:!0,className:"w-full p-2 border border-gray-300 rounded-lg",value:U.regions||[],onChange:e=>{K("regions",Array.from(e.target.selectedOptions,e=>e.value))},children:N.N9.map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Сотрудники (от-до)"}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("input",{type:"number",placeholder:"От",className:"w-full p-2 border border-gray-300 rounded-lg",value:(null==(e=U.employeeRange)?void 0:e.min)||"",onChange:e=>{var t;let a=parseInt(e.target.value)||0;K("employeeRange",{...U.employeeRange,min:a,max:(null==(t=U.employeeRange)?void 0:t.max)||1e4})}}),(0,s.jsx)("input",{type:"number",placeholder:"До",className:"w-full p-2 border border-gray-300 rounded-lg",value:(null==(t=U.employeeRange)?void 0:t.max)||"",onChange:e=>{var t;let a=parseInt(e.target.value)||1e4;K("employeeRange",{...U.employeeRange,min:(null==(t=U.employeeRange)?void 0:t.min)||0,max:a})}})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Выручка (млн руб.)"}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("input",{type:"number",placeholder:"От",className:"w-full p-2 border border-gray-300 rounded-lg",value:(null==(a=U.revenueRange)?void 0:a.min)?U.revenueRange.min/1e6:"",onChange:e=>{var t;let a=1e6*(parseInt(e.target.value)||0);K("revenueRange",{...U.revenueRange,min:a,max:(null==(t=U.revenueRange)?void 0:t.max)||1e9})}}),(0,s.jsx)("input",{type:"number",placeholder:"До",className:"w-full p-2 border border-gray-300 rounded-lg",value:(null==(S=U.revenueRange)?void 0:S.max)?U.revenueRange.max/1e6:"",onChange:e=>{var t;let a=1e6*(parseInt(e.target.value)||1e3);K("revenueRange",{...U.revenueRange,min:(null==(t=U.revenueRange)?void 0:t.min)||0,max:a})}})]})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,s.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Общая выручка"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:(0,N.vv)(D.reduce((e,t)=>e+t.revenue,0))})]}),(0,s.jsx)(j.A,{className:"w-8 h-8 text-green-600"})]})}),(0,s.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Всего сотрудников"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:(0,N.ZV)(D.reduce((e,t)=>e+t.employees,0))})]}),(0,s.jsx)(f.A,{className:"w-8 h-8 text-blue-600"})]})}),(0,s.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Средняя выручка"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:(0,N.vv)(D.length>0?D.reduce((e,t)=>e+t.revenue,0)/D.length:0)})]}),(0,s.jsx)(b.A,{className:"w-8 h-8 text-purple-600"})]})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Распределение по отраслям"}),(0,s.jsx)(n.u,{width:"100%",height:300,children:(0,s.jsxs)(l.E,{data:V,children:[(0,s.jsx)(o.d,{strokeDasharray:"3 3"}),(0,s.jsx)(i.W,{dataKey:"industry",angle:-45,textAnchor:"end",height:100,fontSize:12}),(0,s.jsx)(d.h,{}),(0,s.jsx)(c.m,{formatter:(e,t)=>["count"===t?(0,N.ZV)(e):(0,N.vv)(e),"count"===t?"Количество":"Выручка"]}),(0,s.jsx)(u.y,{dataKey:"count",fill:"#3B82F6",name:"count"})]})})]}),(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Распределение по регионам"}),(0,s.jsx)(n.u,{width:"100%",height:300,children:(0,s.jsxs)(m.r,{children:[(0,s.jsx)(h.F,{data:P.slice(0,8).map(e=>({...e,name:e.region,value:e.count})),cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{name:t,value:a}=e;return"".concat(t,": ").concat(a)},outerRadius:80,fill:"#8884d8",dataKey:"value",children:P.slice(0,8).map((e,t)=>(0,s.jsx)(g.f,{fill:R[t%R.length]},"cell-".concat(t)))}),(0,s.jsx)(c.m,{formatter:e=>[(0,N.ZV)(e),"Количество"]})]})})]}),(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border lg:col-span-2",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Динамика регистрации предприятий"}),(0,s.jsx)(n.u,{width:"100%",height:300,children:(0,s.jsxs)(x.b,{data:_,children:[(0,s.jsx)(o.d,{strokeDasharray:"3 3"}),(0,s.jsx)(i.W,{dataKey:"month"}),(0,s.jsx)(d.h,{}),(0,s.jsx)(c.m,{formatter:(e,t)=>[(0,N.ZV)(e),"count"===t?"Количество":"Выручка"]}),(0,s.jsx)(p.N,{type:"monotone",dataKey:"count",stroke:"#3B82F6",strokeWidth:2,name:"count"})]})})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border",children:[(0,s.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Топ предприяти�� по выручке"})}),(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Название"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Отрасль"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Регион"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Сотрудники"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Выручка"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:D.sort((e,t)=>t.revenue-e.revenue).slice(0,10).map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.name}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.industry}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.region}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,N.ZV)(e.employees)}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,N.vv)(e.revenue)})]},e.id))})]})})]})]})}}},e=>{e.O(0,[524,547,691,441,255,358],()=>e(e.s=3991)),_N_E=e.O()}]);