(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[22],{724:(e,t,s)=>{Promise.resolve().then(s.bind(s,9615))},1169:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(1847).A)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},1172:(e,t,s)=>{"use strict";s.d(t,{AJ:()=>a,Dq:()=>i,MT:()=>n,OK:()=>o,Xz:()=>l,sk:()=>r});let a=e=>{let t=new Map;return e.forEach(e=>{let s=t.get(e.industry)||{count:0,totalRevenue:0,totalEmployees:0};t.set(e.industry,{count:s.count+1,totalRevenue:s.totalRevenue+e.revenue,totalEmployees:s.totalEmployees+e.employees})}),Array.from(t.entries()).map(e=>{let[t,s]=e;return{industry:t,count:s.count,totalRevenue:s.totalRevenue,averageEmployees:Math.round(s.totalEmployees/s.count)}})},r=e=>{let t=new Map;return e.forEach(e=>{let s=t.get(e.region)||{count:0,totalRevenue:0,totalEmployees:0};t.set(e.region,{count:s.count+1,totalRevenue:s.totalRevenue+e.revenue,totalEmployees:s.totalEmployees+e.employees})}),Array.from(t.entries()).map(e=>{let[t,s]=e;return{region:t,count:s.count,totalRevenue:s.totalRevenue,averageEmployees:Math.round(s.totalEmployees/s.count)}})},n=e=>{let t=0,s=[];return e.forEach((e,a)=>{var r;let n=!0,l=[];e.name&&0!==e.name.trim().length||(l.push("Отсутствует название"),n=!1),(null==(r=e.contactInfo)?void 0:r.address)&&0!==e.contactInfo.address.trim().length||(l.push("Отсутствует адрес"),n=!1),e.employees<0&&(l.push("Некорректное количество сотрудников"),n=!1),e.revenue<0&&(l.push("Некорректная выручка"),n=!1),n?t++:s.push("Запись ".concat(a+1,": ").concat(l.join(", ")))}),{totalRecords:e.length,validRecords:t,invalidRecords:e.length-t,validationErrors:s}},l=(e,t)=>e.filter(e=>{if(t.dateRange){let s=new Date(e.registrationDate);if(s<t.dateRange.from||s>t.dateRange.to)return!1}return(!t.industries||!(t.industries.length>0)||!!t.industries.includes(e.industry))&&(!t.regions||!(t.regions.length>0)||!!t.regions.includes(e.region))&&(!t.employeeRange||!(e.employees<t.employeeRange.min)&&!(e.employees>t.employeeRange.max))&&(!t.revenueRange||!(e.revenue<t.revenueRange.min)&&!(e.revenue>t.revenueRange.max))}),o=e=>{let t=new Map;return e.forEach(e=>{let s=new Date(e.registrationDate),a="".concat(s.getFullYear(),"-").concat(String(s.getMonth()+1).padStart(2,"0")),r=t.get(a)||{count:0,revenue:0};t.set(a,{count:r.count+1,revenue:r.revenue+e.revenue})}),Array.from(t.entries()).sort((e,t)=>{let[s]=e,[a]=t;return s.localeCompare(a)}).map(e=>{let[t,s]=e;return{month:t,count:s.count,revenue:s.revenue}})},i=e=>{let t=e.reduce((e,t)=>e+t.revenue,0),s=e.reduce((e,t)=>e+t.employees,0),a=e.reduce((e,t)=>e+t.taxesPaid,0),r=e.filter(e=>"active"===e.status).length,n=e.filter(e=>"inactive"===e.status).length,l=e.filter(e=>"suspended"===e.status).length;return{totalEnterprises:e.length,totalRevenue:t,totalEmployees:s,totalTaxes:a,averageRevenue:e.length>0?t/e.length:0,averageEmployees:e.length>0?s/e.length:0,statusDistribution:{active:r,inactive:n,suspended:l}}}},1524:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(1847).A)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]])},2383:()=>{},3686:()=>{},4951:(e,t,s)=>{"use strict";s.d(t,{Az:()=>m,Bp:()=>o,CO:()=>d,LW:()=>c,N9:()=>l,ZV:()=>u,vv:()=>g});var a=s(4246),r=s(9349),n=s.n(r);let l=["Центральный","Северный","Северо-Восточный","Восточный","Юго-Восточный","Южный","Юго-Западный","Западный","Северо-Западный","Новомосковский","Троицкий"],o=["Машиностроение","Пищевая промышленность","Химическая промышленность","Текстильная промышленность","Металлургия","Электроника","Строительные материалы","Фармацевтика","Автомобилестроение","Полиграфия","Другое"],i=e=>{let t=[];e.name&&"string"==typeof e.name||t.push("Некорректное название предприятия"),e.industry&&o.includes(e.industry)||t.push("Некорректная отрасль"),e.region&&l.includes(e.region)||t.push("Некорректный регион"),(!e.employees||0>Number(e.employees))&&t.push("Некорректное количество сотрудников"),(!e.revenue||0>Number(e.revenue))&&t.push("Некорректная выручка");let s=e.contactInfo;return(null==s?void 0:s.address)||t.push("Отсутствует адрес"),{isValid:0===t.length,errors:t}},d=e=>new Promise(t=>{n().parse(e,{header:!0,complete:e=>{let s=[],a=[],r=0;e.data.forEach((e,t)=>{let n=i(e);if(n.isValid){let t={id:crypto.randomUUID(),name:String(e.name),industry:String(e.industry),region:String(e.region),employees:parseInt(String(e.employees))||0,revenue:parseFloat(String(e.revenue))||0,taxesPaid:parseFloat(String(e.taxesPaid))||0,registrationDate:new Date(String(e.registrationDate)||Date.now()),lastUpdated:new Date,status:e.status||"active",contactInfo:{address:String(e.address),phone:String(e.phone||""),email:String(e.email||"")}};s.push(t)}else r++,a.push("Строка ".concat(t+1,": ").concat(n.errors.join(", ")))}),t({success:!0,message:"Обработано ".concat(s.length," записей из ").concat(e.data.length),processedCount:s.length,errorCount:r,errors:a,data:s})},error:e=>{t({success:!1,message:"Ошибка парсинга CSV: ".concat(e.message),processedCount:0,errorCount:1,errors:[e.message]})}})}),c=e=>new Promise(t=>{let s=new FileReader;s.onload=e=>{try{var s;let r=null==(s=e.target)?void 0:s.result,n=a.LF(r,{type:"binary"}),l=n.SheetNames[0],o=n.Sheets[l],d=a.Wp.sheet_to_json(o),c=[],u=[],g=0;d.forEach((e,t)=>{let s=i(e);if(s.isValid){let t={id:crypto.randomUUID(),name:String(e.name),industry:String(e.industry),region:String(e.region),employees:parseInt(String(e.employees))||0,revenue:parseFloat(String(e.revenue))||0,taxesPaid:parseFloat(String(e.taxesPaid))||0,registrationDate:new Date(String(e.registrationDate)||Date.now()),lastUpdated:new Date,status:e.status||"active",contactInfo:{address:String(e.address),phone:String(e.phone||""),email:String(e.email||"")}};c.push(t)}else g++,u.push("Строка ".concat(t+1,": ").concat(s.errors.join(", ")))}),t({success:!0,message:"Обработано ".concat(c.length," записей из ").concat(d.length),processedCount:c.length,errorCount:g,errors:u,data:c})}catch(e){t({success:!1,message:"Ошибка парсинга Excel: ".concat(e.message),processedCount:0,errorCount:1,errors:[e.message]})}},s.readAsBinaryString(e)}),u=e=>new Intl.NumberFormat("ru-RU").format(e),g=e=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB"}).format(e),m=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=[];for(let s=0;s<e;s++){let e={id:crypto.randomUUID(),name:"Предприятие ".concat(s+1),industry:o[Math.floor(Math.random()*o.length)],region:l[Math.floor(Math.random()*l.length)],employees:Math.floor(1e3*Math.random())+10,revenue:Math.floor(1e8*Math.random())+1e6,taxesPaid:Math.floor(1e7*Math.random())+1e5,registrationDate:new Date(Date.now()-365*Math.random()*432e6),lastUpdated:new Date,status:Math.random()>.1?"active":Math.random()>.5?"inactive":"suspended",contactInfo:{address:"Москва, улица ".concat(s+1,", дом ").concat(Math.floor(100*Math.random())+1),phone:"+7-495-".concat(Math.floor(900*Math.random())+100,"-").concat(Math.floor(90*Math.random())+10,"-").concat(Math.floor(90*Math.random())+10),email:"contact".concat(s+1,"@enterprise.ru")}};t.push(e)}return t}},9408:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(1847).A)("building-2",[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]])},9615:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>g});var a=s(5155),r=s(2115),n=s(9408),l=s(1524),o=s(1169),i=s(9715),d=s(9867),c=s(4951),u=s(1172);function g(){let[e,t]=(0,r.useState)([]),[s,g]=(0,r.useState)(!0),[m,h]=(0,r.useState)(!1),[p,x]=(0,r.useState)({title:"Отчёт по предприятиям Москвы",dateRange:{from:new Date(new Date().getFullYear()-1,0,1),to:new Date},includeIndustries:[],includeRegions:[],sections:{overview:!0,industries:!0,regions:!0,topEnterprises:!0,trends:!0}});(0,r.useEffect)(()=>{t((0,c.Az)(500)),g(!1)},[]);let b=(0,u.Xz)(e,{dateRange:p.dateRange,industries:p.includeIndustries.length>0?p.includeIndustries:void 0,regions:p.includeRegions.length>0?p.includeRegions:void 0}),v=(0,u.Dq)(b),y=(0,u.AJ)(b),f=(0,u.sk)(b),j=async e=>{h(!0),await new Promise(e=>setTimeout(e,2e3));let t=new Blob([JSON.stringify({title:p.title,generatedAt:new Date().toISOString(),period:{from:p.dateRange.from.toISOString(),to:p.dateRange.to.toISOString()},stats:v,industries:y,regions:f,enterprises:b.slice(0,100)},null,2)],{type:"application/json"}),s=URL.createObjectURL(t),a=document.createElement("a");a.href=s,a.download="report_".concat(e,"_").concat(Date.now(),".json"),a.click(),URL.revokeObjectURL(s),h(!1)},w=(e,t)=>{x(s=>({...s,[e]:t}))};return s?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)("div",{className:"text-lg text-gray-600",children:"Загрузка данных..."})}):(0,a.jsxs)("div",{className:"max-w-6xl mx-auto space-y-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Генерация отчётов"}),(0,a.jsx)("p",{className:"text-gray-600 mt-2",children:"Создайте детальные отчёты по предприятиям Москвы в различных форматах"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,a.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Основные настройки"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Название отчёта"}),(0,a.jsx)("input",{type:"text",value:p.title,onChange:e=>w("title",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Дата начала"}),(0,a.jsx)("input",{type:"date",value:p.dateRange.from.toISOString().split("T")[0],onChange:e=>w("dateRange",{...p.dateRange,from:new Date(e.target.value)}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Дата окончания"}),(0,a.jsx)("input",{type:"date",value:p.dateRange.to.toISOString().split("T")[0],onChange:e=>w("dateRange",{...p.dateRange,to:new Date(e.target.value)}),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Фильтры данных"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Отрасли (оставьте пустым для всех)"}),(0,a.jsx)("select",{multiple:!0,value:p.includeIndustries,onChange:e=>{w("includeIndustries",Array.from(e.target.selectedOptions,e=>e.value))},className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",size:6,children:c.Bp.map(e=>(0,a.jsx)("option",{value:e,children:e},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Регионы (оставьте пустым для всех)"}),(0,a.jsx)("select",{multiple:!0,value:p.includeRegions,onChange:e=>{w("includeRegions",Array.from(e.target.selectedOptions,e=>e.value))},className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",size:6,children:c.N9.map(e=>(0,a.jsx)("option",{value:e,children:e},e))})]})]})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Разделы отчёта"}),(0,a.jsx)("div",{className:"space-y-3",children:Object.entries(p.sections).map(e=>{let[t,s]=e;return(0,a.jsxs)("label",{className:"flex items-center space-x-3",children:[(0,a.jsx)("input",{type:"checkbox",checked:s,onChange:e=>{var s;return s=e.target.checked,void x(e=>({...e,sections:{...e.sections,[t]:s}}))},className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),(0,a.jsx)("span",{className:"text-gray-700",children:{overview:"Общая статистика",industries:"Анализ по отраслям",regions:"Анализ по регионам",topEnterprises:"Топ предприятия",trends:"Тренды и динамика"}[t]})]},t)})})]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Превью данных"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(n.A,{className:"w-5 h-5 text-blue-600"}),(0,a.jsx)("span",{className:"text-sm font-medium text-blue-900",children:"Предприятий"})]}),(0,a.jsx)("span",{className:"text-blue-900 font-bold",children:(0,c.ZV)(b.length)})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(l.A,{className:"w-5 h-5 text-green-600"}),(0,a.jsx)("span",{className:"text-sm font-medium text-green-900",children:"Общая выручка"})]}),(0,a.jsx)("span",{className:"text-green-900 font-bold text-sm",children:(0,c.vv)(v.totalRevenue)})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-purple-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(o.A,{className:"w-5 h-5 text-purple-600"}),(0,a.jsx)("span",{className:"text-sm font-medium text-purple-900",children:"Сотрудников"})]}),(0,a.jsx)("span",{className:"text-purple-900 font-bold",children:(0,c.ZV)(v.totalEmployees)})]}),(0,a.jsxs)("div",{className:"pt-3 border-t border-gray-200",children:[(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:["Период: ",p.dateRange.from.toLocaleDateString("ru-RU")," - ",p.dateRange.to.toLocaleDateString("ru-RU")]}),p.includeIndustries.length>0&&(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Отрасли: ",p.includeIndustries.length]}),p.includeRegions.length>0&&(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Регионы: ",p.includeRegions.length]})]})]})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Генерация отчёта"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("button",{onClick:()=>j("pdf"),disabled:m,className:"w-full flex items-center justify-center space-x-2 p-3 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:[m?(0,a.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):(0,a.jsx)(i.A,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"Скачать PDF"})]}),(0,a.jsxs)("button",{onClick:()=>j("excel"),disabled:m,className:"w-full flex items-center justify-center space-x-2 p-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:[m?(0,a.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):(0,a.jsx)(d.A,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"Скачать Excel"})]})]}),(0,a.jsx)("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,a.jsx)("p",{className:"text-xs text-yellow-800",children:"\uD83D\uDCA1 Отчёты генерируются на основе текущих фильтров и выбранных разделов"})})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Быстрые шаблоны"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("button",{onClick:()=>x({...p,title:"Отчёт по всем предприятиям",includeIndustries:[],includeRegions:[],sections:{overview:!0,industries:!0,regions:!0,topEnterprises:!0,trends:!0}}),className:"w-full text-left p-2 text-sm text-blue-600 hover:bg-blue-50 rounded",children:"\uD83D\uDCCA Полный отчёт"}),(0,a.jsx)("button",{onClick:()=>x({...p,title:"Краткая сводка",sections:{overview:!0,industries:!1,regions:!1,topEnterprises:!0,trends:!1}}),className:"w-full text-left p-2 text-sm text-blue-600 hover:bg-blue-50 rounded",children:"\uD83D\uDCCB Краткая сводка"}),(0,a.jsx)("button",{onClick:()=>x({...p,title:"Анализ по отраслям",sections:{overview:!0,industries:!0,regions:!1,topEnterprises:!1,trends:!0}}),className:"w-full text-left p-2 text-sm text-blue-600 hover:bg-blue-50 rounded",children:"\uD83C\uDFED Отраслевой анализ"})]})]})]})]})]})}},9715:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(1847).A)("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},9867:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(1847).A)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]])}},e=>{e.O(0,[524,547,441,255,358],()=>e(e.s=724)),_N_E=e.O()}]);