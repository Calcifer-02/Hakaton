(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[994],{554:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>x});var t=a(5155),r=a(2115),n=a(1786),l=a(1847);let c=(0,l.A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);var d=a(6132);let i=(0,l.A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var o=a(9715),m=a(4951);function x(){let[e,s]=(0,r.useState)(!1),[a,l]=(0,r.useState)(null),[x,h]=(0,r.useState)(!1),u=(0,r.useCallback)(e=>{e.preventDefault(),s(!0)},[]),p=(0,r.useCallback)(e=>{e.preventDefault(),s(!1)},[]),g=(0,r.useCallback)(e=>{e.preventDefault(),s(!1);let a=Array.from(e.dataTransfer.files);a.length>0&&j(a[0])},[]),j=async e=>{h(!0),l(null);try{let s;s=e.name.endsWith(".csv")?await (0,m.CO)(e):e.name.endsWith(".xlsx")||e.name.endsWith(".xls")?await (0,m.LW)(e):{success:!1,message:"Неподдерживаемый формат файла. Поддерживаются только CSV и Excel файлы.",processedCount:0,errorCount:1,errors:["Неподдерживаемый формат файла"]},l(s)}catch(e){l({success:!1,message:"Ошибка при обработке файла: ".concat(e.message),processedCount:0,errorCount:1,errors:[e.message]})}finally{h(!1)}};return(0,t.jsxs)("div",{className:"max-w-4xl mx-auto space-y-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Загрузка данных предприятий"}),(0,t.jsx)("p",{className:"text-gray-600 mt-2",children:"Загрузите файл CSV или Excel с данными о предприятиях Москвы для анализа"})]}),(0,t.jsx)("div",{className:"bg-white rounded-lg shadow-sm border",children:(0,t.jsx)("div",{className:"\n            border-2 border-dashed rounded-lg p-12 text-center transition-colors\n            ".concat(e?"border-blue-400 bg-blue-50":"border-gray-300 hover:border-gray-400","\n          "),onDragOver:u,onDragLeave:p,onDrop:g,children:(0,t.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,t.jsx)("div",{className:"p-4 bg-gray-100 rounded-full",children:(0,t.jsx)(n.A,{className:"w-8 h-8 text-gray-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Перетащите файл сюда или выберите файл"}),(0,t.jsx)("p",{className:"text-gray-500 mt-1",children:"Поддерживаются форматы: CSV, Excel (XLSX, XLS)"})]}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,t.jsxs)("label",{className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 cursor-pointer transition-colors",children:[(0,t.jsx)("input",{type:"file",accept:".csv,.xlsx,.xls",onChange:e=>{let s=e.target.files;s&&s.length>0&&j(s[0])},className:"hidden"}),"Выбрать файл"]}),(0,t.jsx)("button",{onClick:()=>{l({success:!0,message:"Загружены демонстрационные данные",processedCount:100,errorCount:5,errors:["Строка 15: Некорректная отрасль","Строка 23: Отсутствует адрес","Строка 34: Некорректное количество сотрудников","Строка 67: Некорректный регион","Строка 89: Некорректная выручка"]})},className:"border border-gray-300 text-gray-700 px-6 py-3 rounded-lg hover:bg-gray-50 transition-colors",children:"Загрузить демо-данные"})]})]})})}),x&&(0,t.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-blue-900",children:"Обработка файла..."}),(0,t.jsx)("p",{className:"text-blue-700 text-sm",children:"Пожалуйста, подождите"})]})]})}),a&&(0,t.jsxs)("div",{className:"\n          rounded-lg p-6 border\n          ".concat(a.success?"bg-green-50 border-green-200":"bg-red-50 border-red-200","\n        "),children:[(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex items-start space-x-3",children:[a.success?(0,t.jsx)(c,{className:"w-6 h-6 text-green-600 flex-shrink-0"}):(0,t.jsx)(d.A,{className:"w-6 h-6 text-red-600 flex-shrink-0"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold ".concat(a.success?"text-green-900":"text-red-900"),children:a.success?"Загрузка завершена":"Ошибка загрузки"}),(0,t.jsx)("p",{className:"mt-1 ".concat(a.success?"text-green-700":"text-red-700"),children:a.message})]})]}),(0,t.jsx)("button",{onClick:()=>{l(null)},className:"text-gray-400 hover:text-gray-600",children:(0,t.jsx)(i,{className:"w-5 h-5"})})]}),(0,t.jsxs)("div",{className:"mt-4 grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,t.jsx)("div",{className:"bg-white p-4 rounded-lg border",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-2xl font-bold text-green-600",children:a.processedCount}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Обработано записей"})]})}),(0,t.jsx)("div",{className:"bg-white p-4 rounded-lg border",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-2xl font-bold text-red-600",children:a.errorCount}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Ошибок"})]})})]}),a.errors.length>0&&(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Найденные ошибки:"}),(0,t.jsx)("div",{className:"bg-white rounded-lg border max-h-40 overflow-y-auto",children:(0,t.jsxs)("div",{className:"p-4 space-y-2",children:[a.errors.slice(0,10).map((e,s)=>(0,t.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-red-400 rounded-full mt-2 flex-shrink-0"}),(0,t.jsx)("p",{className:"text-sm text-gray-700",children:e})]},s)),a.errors.length>10&&(0,t.jsxs)("p",{className:"text-sm text-gray-500 italic",children:["И ещё ",a.errors.length-10," ошибок..."]})]})})]})]}),(0,t.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Формат данных"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("p",{className:"text-gray-700",children:"Файл должен содержать следующие столбцы:"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(o.A,{className:"w-4 h-4 text-blue-600"}),(0,t.jsx)("span",{className:"font-medium",children:"name"})," - Название предприятия"]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(o.A,{className:"w-4 h-4 text-blue-600"}),(0,t.jsx)("span",{className:"font-medium",children:"industry"})," - Отрасль"]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(o.A,{className:"w-4 h-4 text-blue-600"}),(0,t.jsx)("span",{className:"font-medium",children:"region"})," - Регион Москвы"]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(o.A,{className:"w-4 h-4 text-blue-600"}),(0,t.jsx)("span",{className:"font-medium",children:"employees"})," - Количество сотрудников"]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(o.A,{className:"w-4 h-4 text-blue-600"}),(0,t.jsx)("span",{className:"font-medium",children:"revenue"})," - Выручка (руб.)"]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(o.A,{className:"w-4 h-4 text-blue-600"}),(0,t.jsx)("span",{className:"font-medium",children:"address"})," - Адрес"]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(o.A,{className:"w-4 h-4 text-blue-600"}),(0,t.jsx)("span",{className:"font-medium",children:"phone"})," - Телефон (опционально)"]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(o.A,{className:"w-4 h-4 text-blue-600"}),(0,t.jsx)("span",{className:"font-medium",children:"email"})," - Email (опционально)"]})]})]})]})]})]})}},1786:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(1847).A)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]])},2176:(e,s,a)=>{Promise.resolve().then(a.bind(a,554))},2383:()=>{},3686:()=>{},4951:(e,s,a)=>{"use strict";a.d(s,{Az:()=>h,Bp:()=>c,CO:()=>i,LW:()=>o,N9:()=>l,ZV:()=>m,vv:()=>x});var t=a(4246),r=a(9349),n=a.n(r);let l=["Центральный","Северный","Северо-Восточный","Восточный","Юго-Восточный","Южный","Юго-Западный","Западный","Северо-Западный","Новомосковский","Троицкий"],c=["Машиностроение","Пищевая промышленность","Химическая промышленность","Текстильная промышленность","Металлургия","Электроника","Строительные материалы","Фармацевтика","Автомобилестроение","Полиграфия","Другое"],d=e=>{let s=[];e.name&&"string"==typeof e.name||s.push("Некорректное название предприятия"),e.industry&&c.includes(e.industry)||s.push("Некорректная отрасль"),e.region&&l.includes(e.region)||s.push("Некорректный регион"),(!e.employees||0>Number(e.employees))&&s.push("Некорректное количество сотрудников"),(!e.revenue||0>Number(e.revenue))&&s.push("Некорректная выручка");let a=e.contactInfo;return(null==a?void 0:a.address)||s.push("Отсутствует адрес"),{isValid:0===s.length,errors:s}},i=e=>new Promise(s=>{n().parse(e,{header:!0,complete:e=>{let a=[],t=[],r=0;e.data.forEach((e,s)=>{let n=d(e);if(n.isValid){let s={id:crypto.randomUUID(),name:String(e.name),industry:String(e.industry),region:String(e.region),employees:parseInt(String(e.employees))||0,revenue:parseFloat(String(e.revenue))||0,taxesPaid:parseFloat(String(e.taxesPaid))||0,registrationDate:new Date(String(e.registrationDate)||Date.now()),lastUpdated:new Date,status:e.status||"active",contactInfo:{address:String(e.address),phone:String(e.phone||""),email:String(e.email||"")}};a.push(s)}else r++,t.push("Строка ".concat(s+1,": ").concat(n.errors.join(", ")))}),s({success:!0,message:"Обработано ".concat(a.length," записей из ").concat(e.data.length),processedCount:a.length,errorCount:r,errors:t,data:a})},error:e=>{s({success:!1,message:"Ошибка парсинга CSV: ".concat(e.message),processedCount:0,errorCount:1,errors:[e.message]})}})}),o=e=>new Promise(s=>{let a=new FileReader;a.onload=e=>{try{var a;let r=null==(a=e.target)?void 0:a.result,n=t.LF(r,{type:"binary"}),l=n.SheetNames[0],c=n.Sheets[l],i=t.Wp.sheet_to_json(c),o=[],m=[],x=0;i.forEach((e,s)=>{let a=d(e);if(a.isValid){let s={id:crypto.randomUUID(),name:String(e.name),industry:String(e.industry),region:String(e.region),employees:parseInt(String(e.employees))||0,revenue:parseFloat(String(e.revenue))||0,taxesPaid:parseFloat(String(e.taxesPaid))||0,registrationDate:new Date(String(e.registrationDate)||Date.now()),lastUpdated:new Date,status:e.status||"active",contactInfo:{address:String(e.address),phone:String(e.phone||""),email:String(e.email||"")}};o.push(s)}else x++,m.push("Строка ".concat(s+1,": ").concat(a.errors.join(", ")))}),s({success:!0,message:"Обработано ".concat(o.length," записей из ").concat(i.length),processedCount:o.length,errorCount:x,errors:m,data:o})}catch(e){s({success:!1,message:"Ошибка парсинга Excel: ".concat(e.message),processedCount:0,errorCount:1,errors:[e.message]})}},a.readAsBinaryString(e)}),m=e=>new Intl.NumberFormat("ru-RU").format(e),x=e=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB"}).format(e),h=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,s=[];for(let a=0;a<e;a++){let e={id:crypto.randomUUID(),name:"Предприятие ".concat(a+1),industry:c[Math.floor(Math.random()*c.length)],region:l[Math.floor(Math.random()*l.length)],employees:Math.floor(1e3*Math.random())+10,revenue:Math.floor(1e8*Math.random())+1e6,taxesPaid:Math.floor(1e7*Math.random())+1e5,registrationDate:new Date(Date.now()-365*Math.random()*432e6),lastUpdated:new Date,status:Math.random()>.1?"active":Math.random()>.5?"inactive":"suspended",contactInfo:{address:"Москва, улица ".concat(a+1,", дом ").concat(Math.floor(100*Math.random())+1),phone:"+7-495-".concat(Math.floor(900*Math.random())+100,"-").concat(Math.floor(90*Math.random())+10,"-").concat(Math.floor(90*Math.random())+10),email:"contact".concat(a+1,"@enterprise.ru")}};s.push(e)}return s}},6132:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(1847).A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},9715:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(1847).A)("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])}},e=>{e.O(0,[524,547,441,255,358],()=>e(e.s=2176)),_N_E=e.O()}]);